{% extends "header.html" %}
{% block main %}

  <div class='row'>
    <div class='col-sm-10 col-md-9'>
      <div class="panel panel-default" style="background:inherit;">
        <h5>Update {{ gesture.name }}</h5>
        <form method='post'
              action='{{ url_for('update_gesture', gesture_id=gesture.id) }}'>
          <div class="form-group form-group-sm">
            <div class='row'>
              {% for field in gesture_form %}
                {% if field.name == 'name' %}
                  <div class='col-sm-5'>
                {% elif field.name in ['specialty_id'] %}
                  <div class='col-sm-2'>
                {% elif field.name in ['color', 'submit','code','alias'] %}
                  <div class='col-sm-1'>
                {% endif %}
                {% if field.name not in ['color', 'submit'] %}
                  <h6>{{ field.label() }}</h6>
                {% else %}
                  <h6>{{ field.label(class="sr-only") }}_</h6>
                {% endif %}
                {% if field.type == 'SubmitField' %}
                  {{ field(class="form-control btn btn-default") }}
                {% else %}
                  {{ field(class="form-control") }}
                {% endif %}
                </div>
              {% endfor %}
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class='col-sm-2 col-md-3'>
      <div class="panel panel-default">
        <h5>Cotations</h5>
        {% for cotation in gesture.cotations 
                        if cotation.healthcare_plan.active %}
          <a href="{{ url_for('update_cotation', 
                                cotation_id=cotation.healthcare_plan.id) }}"
              class="btn btn-primary btn-sm">
            {{ cotation.healthcare_plan.name }}</a> 
          <button class="btn btn-default btn-sm disabled">
            {{ cotation.price }} {{ constants.CURRENCY_SYMBOL }}</button>
          </p>
        {% endfor %}
      </div>
      <div class="panel panel-default">
        <h5>Healthcare plans</h5>
        {% for new_HC_plan in healthcare_plans_not_in_gesture %}
          <p>{{ new_HC_plan.name }} 
            <a href="{{ url_for('add_healthcare_plan_to_gesture', 
                              gesture_id=gesture.id,
                              healthcare_plan_id=new_HC_plan.id)}}">
                  Add</a>
          </p>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="row">
      <div class='col-sm-12'>
        <h5>Materials</h5>
        {% for materials in materials_list %}
          {% if not loop.index0 % 3 %}
            <div class='row'>
          {% endif %}
              <div class='col-sm-4'>
                <h6 
                  style='background-color:
                      {{ materials[1][0].asset_specialty.color }}'>
                {{ materials[0] }}</h6>
                {% for material in materials[1] %}
                  <a href="{{ url_for('update_material_category',
                                      material_category_id=material.id) }}">
                    {{ material.commercial_name }} {{ material.brand }}</a><br>
                {% endfor %}
              </div>
          {% if not (loop.index0 + 1) % 3 %}
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
{#
{% for cotation in gesture.cotations if cotation.healthcare_plan.active %}
  {% if cotation.active == True %}
    {{ cotation.healthcare_plan.name }} : {{ cotation.price }} {{ constants.CURRENCY_SYMBOL }}
    <a href="{{ url_for('update_cotation', cotation_id=cotation.id) }}"> <strong>Update</strong> </a>
    or 
    <a href="{{ url_for('remove_healthcare_plan_from_gesture',
                        gesture_id=gesture.id,
                        healthcare_plan_id=cotation.healthcare_plan.id) }}">
      Remove</a>
    <br />
  {% endif %}

{% endfor %}

<br />
<strong>Healthcare plan out of gesture:</strong> <br />
<br />
{% from "_formhelpers.html" import render_simple_field_line, 
                                  render_simple_hidden_field %}
{% block main %}
<br />
Global Gesture : ({{ gesture.id }}) : {{ gesture.specialty.name }}, {{gesture.name }}
<br />
Materials that may be envolve in global gesture : <br/> 

<br /><br />
<strong>Healthcare plans in gesture:</strong> <br />
{# {% for cotation, price_form in price_forms %}
  <form method="post" 
        action="{{ url_for('update_cotation') }}">
  {{ cotation.healthcare_plan.name }} --
  {{ render_simple_hidden_field(price_form.gesture_id) }}
  {{ render_simple_hidden_field(price_form.healthcare_plan_id) }}
  {{ render_simple_field_line(price_form.price) }}
  {{ cotation.healthcare_plan.active }} 
  <input type="submit" value="Update"> 
# }


{% endblock %}
#}
